\begin{algorithm}[H]\fontfamily{lmss}
\caption{Textbook \& Private Information Retrieval}\label{a:pir}
\begin{algorithmic}[1]
\renewcommand{\algorithmicrequire}{\textbf{Private Vars:}}

\Procedure{IR}{$table[N][2], key$}
    \State $value \gets 0$
    \For{$i \in \{0, \dots, N-1\}$}
        \If{$table[i][0] = key$}
            \State $value \gets table[i][1]$
            \State \textbf{return} {$value$} \Comment{\small{Return the value that corresponds to the requested key}}
        \EndIf
    \EndFor
    \State \textbf{return} {$value$} \Comment{\small{If key not found return $0$}}
\EndProcedure

\begin{spacing}{0.5}
\end{spacing}

\Require ${\color{darkred}{table}}, {\color{darkred}{key}}, {\color{darkred}{sum}}, {\color{darkred}{value}}, {\color{darkred}{eq}}$
\Procedure{PIR}{${\color{darkred}{table}}[N], {\color{darkred}{key}}$}
    \State ${\color{darkred}{sum}} \gets \enc{0}$
    \For{$i \in \{0, \dots, N-1\}$}
        \State ${\color{darkred}{value}} \gets {\color{darkred}{table}}[i][1]$

        \State ${\color{darkred}{eq}} \gets ({\color{darkred}{table}}[i][0] \heq {\color{darkred}{key}})$\Comment{\small{${\color{darkred}{eq}}$ obliviously gets either $\enc{1}$ if $table[i][0] = key$, or $\enc{1}$ otherwise}}

        \State ${\color{darkred}{sum}} \gets ({\color{darkred}{eq}} \hmul {\color{darkred}{value}}) \hplus ((\enc{1} \hminus {\color{darkred}{eq}}) \hmul {\color{darkred}{sum}})$\Comment{\small{Obliviously update the value of ${\color{darkred}{sum}}$}}
    \EndFor
    \State \textbf{return} {${\color{darkred}{sum}}$}
\EndProcedure

\end{algorithmic}
\end{algorithm}
