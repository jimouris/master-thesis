\begin{algorithm}[H]\fontfamily{lmss}
\caption{Privacy Preserving C4.5 Algorithm}\label{a:c45-pp}
\begin{algorithmic}[1]
  \renewcommand{\algorithmicrequire}{\textbf{Private Vars:}}
  \Require ${\color{darkred}{{\color{darkred}{examples}}}}, {\color{darkred}{allSame}}, {\color{darkred}{subset}}, {\color{darkred}{less}}, {\color{darkred}{greater}}, {\color{darkred}{bestSplitted}}$
  \renewcommand{\algorithmicrequire}{\textbf{Global Vars:}}
  \Require $classAttribute, categoricalAttributes$
\Procedure{C45}{${\color{darkred}{examples}}, attributes$}
    \If   {$attributes = \{\}$}\Comment{{\small If number of predicting attributes is empty}}
          \State \textbf{return} $\textsc{MostCommonLabel}({\color{darkred}{examples}})$\Comment{{\small Return the label with the most common \par\hfill value of the target attribute in the examples}}
    \ElsIf {${\color{darkblue}{\textsc{Declassify}}}({\color{darkred}{\textsc{AllExamplesSame}}}({\color{darkred}{examples}}))$}
      \State ${\color{darkred}{label}} \gets \enc{-1}$
      \For{${\color{darkred}{example}} \in {\color{darkred}{examples}}$}
          \State ${\color{darkred}{neq}} \gets {\color{darkred}{example}}[classAttribute] \hneq \enc{-1}$
          \State ${\color{darkred}{label}} \gets {\color{darkred}{neq}} \hmul {\color{darkred}{example}}[classAttribute] \hplus (\enc{1} - {\color{darkred}{neq}}) \hmul {\color{darkred}{label}} $
      \EndFor
      \State \textbf{return} {{\color{darkblue}{\textsc{Declassify}}}}$({\color{darkred}{label}})$
    \EndIf


    \State $(bestAttribute, bestThreshold, {\color{darkred}{bestSplitted}}) \gets \textsc{Best}({\color{darkred}{examples}}, attributes)$\Comment{{\small Best \par\hfill attribute is the one whose split provides maximum information gain. ${\color{darkred}{bestSplitted}}$ \par\hfill corresponds to the subsets generated by that split. }}
    \State $branches \gets \{\}$

    \algstore{myalg}
    \end{algorithmic}
    \end{algorithm}
    \begin{algorithm}
    \begin{algorithmic} [1]
    \algrestore{myalg}

    \If {$bestAttribute \in categoricalAttributes$}\Comment{{\small If best attribute is categorical}}
      \For{{\small each possible value} $v_i$ {\small of} $bestAttribute$}
          \State {\small Let} $branch$ {\small be a new tree branch corresponding to} $bestAttribute = v_i$
          \State ${\color{darkred}{subset}} \gets {\color{darkred}{bestSplitted}}[v_i]$

          \If {{\color{darkblue}{\textsc{Declassify}}}$(\textsc{CountPositives}(subset) \heq \enc{0})$}
              \State $branch \gets \textsc{AddLeaf}(branch, \textsc{MostCommonLabel}({\color{darkred}{examples}})))$
          \Else
              \State $branch \gets \textsc{AddTree}(branch, \textsc{C45}({\color{darkred}{subset}},$ $attributes - \{bestAttribute\}))$\par\hfill
          \EndIf
          \State $branches \gets branches \cup branch$
      \EndFor
    \Else
      \State {\small Let} $branch$ {\small be a new tree branch corresponding to} $bestAttribute <= bestThreshold$
      \State ${\color{darkred}{less}} \gets {\color{darkred}{bestSplitted}}[0]$
      \If {{\color{darkblue}{\textsc{Declassify}}}$(\textsc{CountPositives}({\color{darkred}{less}}) \heq \enc{0})$}
          \State $branch \gets \textsc{AddLeaf}(branch, \textsc{MostCommonLabel}({\color{darkred}{examples}})))$
      \Else
          \State $branch \gets \textsc{AddTree}(branch, \textsc{C45}({\color{darkred}{less}},$ $attributes - \{bestAttribute\}))$\par\hfill
      \EndIf
      \State $branches \gets branches \cup branch$
      \State {\small Let} $branch$ {\small be a new tree branch corresponding to} $bestAttribute > bestThreshold$
      \State ${\color{darkred}{greater}} \gets {\color{darkred}{bestSplitted}}[1]$
      \If {{\color{darkblue}{\textsc{Declassify}}}$(\textsc{CountPositives}({\color{darkred}{greater}}) \heq \enc{0})$}
          \State $branch \gets \textsc{AddLeaf}(branch, \textsc{MostCommonLabel}({\color{darkred}{examples}})))$
      \Else
          \State $branch \gets \textsc{AddTree}(branch, \textsc{C45}({\color{darkred}{greater}},$ $attributes - \{bestAttribute\}))$\par\hfill
      \EndIf
      \State $branches \gets branches \cup branch$
    \EndIf
    \State \textbf{return} $branches$
\EndProcedure
\end{algorithmic}
\end{algorithm}

